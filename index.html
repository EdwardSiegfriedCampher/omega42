// Sample prompt data - Now loaded from localStorage if available
let promptData = {
    life: [],
    science: [],
    consciousness: [],
    technology: [],
    society: [],
    growth: []
};

// Default essential prompts
const defaultPrompts = [
    "What is the fundamental nature of reality according to Omega 42?",
    "How does consciousness create the universe?",
    "What is the significance of the number 42 in cosmic terms?",
    "How can I apply Omega 42 principles in daily life?",
    "What role does the golden ratio play in universal structure?",
    "How does Omega 42 explain the connection between mind and matter?"
];

// DOM Elements
const categorySelect = document.getElementById('category-select');
const promptsGrid = document.getElementById('prompts-grid');
const totalPromptsEl = document.getElementById('total-prompts');
const categoryPromptsEl = document.getElementById('category-prompts');
const copiedCountEl = document.getElementById('copied-count');
const copyNotification = document.getElementById('copy-notification');

// ... (keep all your existing DOM element references)

// State variables
let copiedCount = 0;
const GITHUB_URL = "https://github.com/EdwardSiegfriedCampher/omega42";
const STORAGE_KEY = "omega42_prompts_v1";

// Initialize prompt data from localStorage
function loadPromptsFromStorage() {
    const savedPrompts = localStorage.getItem(STORAGE_KEY);
    if (savedPrompts) {
        try {
            const parsed = JSON.parse(savedPrompts);
            // Merge with default structure
            promptData = {
                ...promptData,
                ...parsed
            };
        } catch (e) {
            console.error("Failed to parse saved prompts", e);
        }
    }
}

// Save prompts to localStorage
function savePromptsToStorage() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(promptData));
}

// Modified prompt submission handler
function handleSubmitPrompt() {
    const text = promptText.value.trim();
    const category = promptCategory.value;
    
    if (!text) {
        showFeedback("Please enter a prompt", "error");
        return;
    }
    
    // Check for uniqueness across all categories
    let isUnique = true;
    for (const cat in promptData) {
        if (promptData[cat].includes(text)) {
            isUnique = false;
            break;
        }
    }
    
    if (!isUnique) {
        showFeedback("This prompt already exists in our collection", "error");
        return;
    }
    
    // Add to prompt data
    if (!promptData[category]) {
        promptData[category] = [];
    }
    promptData[category].push(text);
    
    // Save to localStorage
    savePromptsToStorage();
    
    // Update UI
    totalPromptsEl.textContent = getTotalPrompts();
    
    // If current category is the same, update display
    if (categorySelect.value === category) {
        handleCategorySelect();
    } else if (categorySelect.value === "") {
        showDefaultPrompts();
    }
    
    showFeedback("Thank you! Your prompt has been saved locally.", "success");
    promptText.value = '';
}

// Modified initialization
function initPage() {
    // Load saved prompts first
    loadPromptsFromStorage();
    
    // Initialize counters
    totalPromptsEl.textContent = getTotalPrompts();
    showDefaultPrompts();
    
    // ... (keep all your existing event listeners)
}

// ... (keep all your existing helper functions like getTotalPrompts, showDefaultPrompts, etc.)

// Initialize when page loads
window.addEventListener('DOMContentLoaded', initPage);
